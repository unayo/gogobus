(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59abe2ee"],{"128d":function(t,e,o){},"4c95":function(t,e,o){"use strict";o.r(e);var n=o("7a23"),c=o("e854"),a=o.n(c),i={class:"container py-5"},s=Object(n["f"])("div",{class:"d-flex flex-wrap justify-content-between mb-4"},[Object(n["f"])("h3",{class:"text-primary"},"Bus Stop | 附近站牌"),Object(n["f"])("div",{class:"search-width position-relative"},[Object(n["f"])("input",{type:"text",class:"form-control text-center",placeholder:"快速搜尋","aria-label":"search stop","aria-describedby":"search-stop"}),Object(n["f"])("button",{class:"search-btn btn pe-4",type:"button",id:"search-stop"},[Object(n["f"])("img",{class:"search-icon",src:a.a,alt:"search icon"})])])],-1),r={class:"bg-white p-5 rounded-1 shadow-sm"},l=Object(n["f"])("h5",null,"附近的站牌",-1),u={class:"list-btn list-group flex-row"},b=Object(n["f"])("h5",{class:"m-0"},"300 m",-1),d=[b],p=Object(n["f"])("h5",{class:"m-0"},"500 m",-1),f=[p],h={class:"distance"};function g(t,e,o,c,a,b){var p=Object(n["w"])("NearBy");return Object(n["r"])(),Object(n["e"])("div",i,[s,Object(n["f"])("div",r,[l,Object(n["f"])("ul",u,[Object(n["f"])("li",{onClick:e[0]||(e[0]=function(t){return b.change(300)}),class:Object(n["n"])([a.distanceBtn?"active":"","list-group-item list-group-item-action border-0 text-center"])},d,2),Object(n["f"])("li",{onClick:e[1]||(e[1]=function(t){return b.change(500)}),class:Object(n["n"])([a.distanceBtn?"":"active","list-group-item list-group-item-action border-0 text-center"])},f,2)]),Object(n["f"])("div",h,[Object(n["h"])(p,{getInfo:a.toApi},null,8,["getInfo"])])])])}o("99af"),o("d3b7"),o("159b");var O=o("6c2d"),j={class:"hello"},v={class:"table table-striped table-hover"},m={class:"px-4 py-3"},w={class:"text-primary"};function y(t,e,o,c,a,i){return Object(n["r"])(),Object(n["e"])("div",j,[Object(n["f"])("table",v,[Object(n["f"])("tbody",null,[(Object(n["r"])(!0),Object(n["e"])(n["a"],null,Object(n["v"])(o.getInfo.api,(function(t){return Object(n["r"])(),Object(n["e"])("tr",{key:t.StopUID},[Object(n["f"])("td",m,[Object(n["f"])("h5",w,Object(n["y"])(t.StationName.Zh_tw),1),Object(n["f"])("p",null,"方位角： "+Object(n["y"])(t.Bearing),1),(Object(n["r"])(!0),Object(n["e"])(n["a"],null,Object(n["v"])(o.getInfo.busApi,(function(t){return Object(n["r"])(),Object(n["e"])("small",{key:t.RouteUID},Object(n["y"])(t.RouteID)+"、 ",1)})),128))])])})),128))])])])}var A={props:{getInfo:{type:Object,default:function(){return{}}}}},B=o("6b0d"),x=o.n(B);const D=x()(A,[["render",y]]);var I=D,S={components:{NearBy:I},data:function(){return{nowLocation:{latitude:25.047675,longitude:121.517055},toApi:{api:[],busApi:[]},distanceData:300,distanceBtn:!0}},methods:{getGeo:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){console.log(e.coords.latitude),console.log(e.coords.longitude),t.nowLocation.latitude=e.coords.latitude,t.nowLocation.longitude=e.coords.longitude,t.getApi()}),(function(t){console.log(t.message)})):console.log("Your browser does not support geolocation API")},apiID:function(){var t="d270b525f2114a95895b7670090cb92c",e="Pwts_rFo3XHtvuvjDziNlG6fqvM",o=(new Date).toGMTString(),n=new O["a"]("SHA-1","TEXT");n.setHMACKey(e,"TEXT"),n.update("x-date: "+o);var c=n.getHMAC("B64"),a='hmac username="'.concat(t,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(c,'"');return{Authorization:a,"X-Date":o}},getApi:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bus/Station/NearBy?$top=30&$spatialFilter=nearby(".concat(this.nowLocation.latitude,", ").concat(this.nowLocation.longitude,", ").concat(this.distanceData,")&$format=JSON");this.$http.get(e,{headers:this.apiID()}).then((function(e){t.toApi.api=e.data,console.log("ok取得指定[位置,範圍]的全臺公車站牌資料",t.api),t.getBus()})).catch((function(t){console.log("error",t.response)}))},getBus:function(){var t=this;this.toApi.api.forEach((function(e){var o="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Taichung/PassThrough/Station/".concat(e.StationID,"?$top=30&$format=JSON");t.$http.get(o,{headers:t.apiID()}).then((function(e){console.log("ok 公車路線",e.data),t.toApi.busApi=e.data})).catch((function(t){console.log("error 公車路線",t.response)}))}))},change:function(t){this.distanceData=t,this.getApi(),300===this.distanceData?this.distanceBtn=!0:this.distanceBtn=!1}},created:function(){this.getGeo()}};o("5146");const k=x()(S,[["render",g]]);e["default"]=k},5146:function(t,e,o){"use strict";o("128d")}}]);
//# sourceMappingURL=chunk-59abe2ee.4e49531f.js.map