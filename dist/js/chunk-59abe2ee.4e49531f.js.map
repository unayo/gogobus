{"version":3,"sources":["webpack:///./src/views/StopInfo.vue","webpack:///./src/components/NearbyStop.vue","webpack:///./src/components/NearbyStop.vue?ca7b","webpack:///./src/views/StopInfo.vue?3773","webpack:///./src/views/StopInfo.vue?4ff7"],"names":["class","type","placeholder","aria-label","aria-describedby","id","src","alt","change","distanceBtn","getInfo","toApi","api","item","StopUID","StationName","Zh_tw","Bearing","busApi","RouteUID","RouteID","props","Object","default","__exports__","components","NearBy","data","nowLocation","latitude","longitude","distanceData","methods","getGeo","navigator","geolocation","getCurrentPosition","position","console","log","coords","getApi","error","message","apiID","AppID","AppKey","GMTString","Date","toGMTString","ShaObj","setHMACKey","update","HMAC","getHMAC","Authorization","urlData","this","$http","get","headers","then","res","getBus","catch","response","forEach","StationID","distance","created","render"],"mappings":"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","file":"js/chunk-59abe2ee.4e49531f.js","sourcesContent":["<template>\n<div class=\"container py-5\">\n  <div class=\"d-flex flex-wrap justify-content-between mb-4\">\n    <h3 class=\"text-primary\">Bus Stop | 附近站牌</h3>\n    <div class=\"search-width position-relative\">\n      <input type=\"text\" class=\"form-control text-center\" placeholder=\"快速搜尋\" aria-label=\"search stop\" aria-describedby=\"search-stop\">\n      <button class=\"search-btn btn pe-4\" type=\"button\" id=\"search-stop\">\n        <img class=\"search-icon\" src=\"../assets/images/icon-search.svg\" alt=\"search icon\">\n      </button>\n    </div>\n  </div>\n  <div class=\"bg-white p-5 rounded-1 shadow-sm\">\n    <h5>附近的站牌</h5>\n    <ul class=\"list-btn list-group flex-row\">\n      <li\n        @click=\"change(300)\"\n        :class=\"distanceBtn? 'active' : ''\"\n        class=\"list-group-item list-group-item-action border-0 text-center\">\n        <h5 class=\"m-0\">300 m</h5>\n      </li>\n      <li\n        @click=\"change(500)\"\n        :class=\"distanceBtn? '' : 'active'\"\n        class=\"list-group-item list-group-item-action border-0 text-center\">\n        <h5 class=\"m-0\">500 m</h5>\n      </li>\n    </ul>\n    <div class=\"distance\">\n      <NearBy\n        :getInfo=\"toApi\">\n      </NearBy>\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\">\n  // search bar\n  body {\n    background-color: #F5F6FF;\n  }\n  .search-width {\n    width: 311px;\n  }\n  .form-control {\n    padding-right: 65px;\n  }\n  .search-btn {\n    position: absolute;\n    right: 0;\n    top: 0;\n    .search-icon {\n      filter: brightness(0.7);\n    }\n  }\n  // 分隔選單\n  .list-btn {\n    border-radius: 1rem 1rem 0 0;\n    overflow: hidden;\n  }\n  .distance {\n    background-color: #ECEEFF;\n    height: 60vh;\n    overflow: scroll;\n  }\n  .list-group-item {\n    border-radius: 1rem 1rem 0 0;\n    background-color: #BFCDFF;\n    color: white;\n    width: 50%;\n    &:first-child {\n      border-radius: 1rem 0 0 0;\n    }\n    &:last-child {\n      border-radius: 0 1rem 0 0;\n    }\n  }\n</style>\n\n<script>\nimport JsSHA from 'jssha'\nimport NearBy from '@/components/NearbyStop.vue'\n\nexport default {\n  components: {\n    NearBy\n  },\n  data () {\n    return {\n      nowLocation: {\n        latitude: 25.047675,\n        longitude: 121.517055\n      },\n      toApi: {\n        api: [],\n        busApi: []\n      },\n      distanceData: 300,\n      distanceBtn: true\n    }\n  },\n  methods: {\n    // 取得當下位置\n    getGeo () {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          console.log(position.coords.latitude)\n          console.log(position.coords.longitude)\n          // 重新定位\n          this.nowLocation.latitude = position.coords.latitude\n          this.nowLocation.longitude = position.coords.longitude\n          // 取得定位後，串接 api\n          this.getApi()\n        },\n        error => {\n          console.log(error.message)\n        })\n      } else {\n        console.log('Your browser does not support geolocation API')\n      }\n    },\n    apiID () {\n      // API 驗證\n      const AppID = process.env.VUE_APP_ID\n      const AppKey = process.env.VUE_APP_KEY\n      const GMTString = new Date().toGMTString()\n      const ShaObj = new JsSHA('SHA-1', 'TEXT')\n      ShaObj.setHMACKey(AppKey, 'TEXT')\n      ShaObj.update('x-date: ' + GMTString)\n      const HMAC = ShaObj.getHMAC('B64')\n      const Authorization = `hmac username=\"${AppID}\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"${HMAC}\"`\n      return { Authorization: Authorization, 'X-Date': GMTString }\n    },\n    // 取得指定[位置,範圍]的全臺公車站牌資料\n    getApi () {\n      const urlData = `https://ptx.transportdata.tw/MOTC/v2/Bus/Station/NearBy?$top=30&$spatialFilter=nearby(${this.nowLocation.latitude}, ${this.nowLocation.longitude}, ${this.distanceData})&$format=JSON`\n      this.$http.get(urlData,\n        {\n          headers: this.apiID()\n        })\n        .then((res) => {\n          this.toApi.api = res.data\n          console.log('ok取得指定[位置,範圍]的全臺公車站牌資料', this.api)\n          // bus api\n          this.getBus()\n        })\n        .catch(error => {\n          console.log('error', error.response)\n        })\n    },\n    // 取得指定站牌(item)公車路線資料\n    getBus () {\n      // 找到 getInfo 的 StationID\n      this.toApi.api.forEach((item) => {\n        const urlData = `https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Taichung/PassThrough/Station/${item.StationID}?$top=30&$format=JSON`\n        this.$http.get(urlData,\n          {\n            headers: this.apiID()\n          })\n          .then((res) => {\n            console.log('ok 公車路線', res.data)\n            this.toApi.busApi = res.data\n          })\n          .catch(error => {\n            console.log('error 公車路線', error.response)\n          })\n      })\n    },\n    // 更改距離\n    change (distance) {\n      this.distanceData = distance\n      this.getApi()\n      // 切換按鈕 style: active\n      if (this.distanceData === 300) {\n        this.distanceBtn = true\n      } else {\n        this.distanceBtn = false\n      }\n    }\n  },\n  created () {\n    this.getGeo()\n  }\n}\n</script>\n","<template>\n  <div class=\"hello\">\n    <table class=\"table table-striped table-hover\">\n      <tbody>\n        <template v-for=\"item in getInfo.api\" :key=\"item.StopUID\">\n          <tr>\n          <td class=\"px-4 py-3\">\n            <h5 class=\"text-primary\">{{ item.StationName.Zh_tw }}</h5>\n            <p>方位角： {{ item.Bearing }}</p>\n            <template v-for=\"item in getInfo.busApi\" :key=\"item.RouteUID\">\n              <small>\n                {{ item.RouteID }}、\n              </small>\n            </template>\n          </td>\n        </tr>\n        </template>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\n\nexport default {\n  props: {\n    getInfo: {\n      // api\n      type: Object,\n      default () {\n        return {}\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n</style>\n","import { render } from \"./NearbyStop.vue?vue&type=template&id=0595cc34\"\nimport script from \"./NearbyStop.vue?vue&type=script&lang=js\"\nexport * from \"./NearbyStop.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/pine_yu/Documents/my project/bus/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./StopInfo.vue?vue&type=template&id=8cd64bca\"\nimport script from \"./StopInfo.vue?vue&type=script&lang=js\"\nexport * from \"./StopInfo.vue?vue&type=script&lang=js\"\n\nimport \"./StopInfo.vue?vue&type=style&index=0&id=8cd64bca&lang=scss\"\n\nimport exportComponent from \"/Users/pine_yu/Documents/my project/bus/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./StopInfo.vue?vue&type=style&index=0&id=8cd64bca&lang=scss\""],"sourceRoot":""}