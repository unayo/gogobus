{"version":3,"sources":["webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./src/views/StopInfo.vue","webpack:///./src/components/NearbyStop.vue","webpack:///./src/components/NearbyStop.vue?ca7b","webpack:///./src/views/StopInfo.vue?3773","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./src/views/StopInfo.vue?9e1c"],"names":["global","DOMIterables","DOMTokenListPrototype","forEach","createNonEnumerableProperty","handlePrototype","CollectionPrototype","error","COLLECTION_NAME","prototype","$forEach","arrayMethodIsStrict","STRICT_METHOD","module","exports","callbackfn","this","arguments","length","undefined","class","change","distanceBtn","getInfo","toApi","api","item","StopUID","StationName","Zh_tw","Bearing","busApi","RouteUID","RouteID","props","type","Object","default","__exports__","components","NearBy","data","nowLocation","latitude","longitude","distanceData","methods","getGeo","navigator","geolocation","getCurrentPosition","position","console","log","coords","getApi","message","apiID","AppID","AppKey","GMTString","Date","toGMTString","ShaObj","setHMACKey","update","HMAC","getHMAC","Authorization","urlData","$http","get","headers","then","res","getBus","catch","response","StationID","distance","created","render","fails","METHOD_NAME","argument","method","call"],"mappings":"qGAAA,IAAIA,EAAS,EAAQ,QACjBC,EAAe,EAAQ,QACvBC,EAAwB,EAAQ,QAChCC,EAAU,EAAQ,QAClBC,EAA8B,EAAQ,QAEtCC,EAAkB,SAAUC,GAE9B,GAAIA,GAAuBA,EAAoBH,UAAYA,EAAS,IAClEC,EAA4BE,EAAqB,UAAWH,GAC5D,MAAOI,GACPD,EAAoBH,QAAUA,IAIlC,IAAK,IAAIK,KAAmBP,EACtBA,EAAaO,IACfH,EAAgBL,EAAOQ,IAAoBR,EAAOQ,GAAiBC,WAIvEJ,EAAgBH,I,oCCpBhB,IAAIQ,EAAW,EAAQ,QAAgCP,QACnDQ,EAAsB,EAAQ,QAE9BC,EAAgBD,EAAoB,WAIxCE,EAAOC,QAAWF,EAGd,GAAGT,QAH2B,SAAiBY,GACjD,OAAOL,EAASM,KAAMD,EAAYE,UAAUC,OAAS,EAAID,UAAU,QAAKE,K,uFCRrEC,MAAM,kB,EACT,eAEM,OAFDA,MAAM,QAAM,CACf,eAA6C,MAAzCA,MAAM,gBAAe,qB,MAEtBA,MAAM,oC,EACT,eAAc,UAAV,SAAK,G,GACLA,MAAM,gC,EAKN,eAA0B,MAAtBA,MAAM,OAAM,SAAK,G,GAArB,G,EAMA,eAA0B,MAAtBA,MAAM,OAAM,SAAK,G,GAArB,G,GAGCA,MAAM,Y,+EApBf,eA0BM,MA1BN,EA0BM,CAzBJ,EAGA,eAqBM,MArBN,EAqBM,CApBJ,EACA,eAaK,KAbL,EAaK,CAZH,eAKK,MAJF,QAAK,+BAAE,EAAAC,OAAM,OACbD,MAAK,gBAAE,EAAAE,YAAW,YACb,iE,KAGR,eAKK,MAJF,QAAK,+BAAE,EAAAD,OAAM,OACbD,MAAK,gBAAE,EAAAE,YAAW,YACb,iE,OAIV,eAIM,MAJN,EAIM,CAHJ,eAES,GADNC,QAAS,EAAAC,OAAK,0B,iDCtBhBJ,MAAM,S,GACFA,MAAM,mC,GAIHA,MAAM,a,GACJA,MAAM,gB,gDANpB,eAkBM,MAlBN,EAkBM,CAjBJ,eAgBQ,QAhBR,EAgBQ,CAfN,eAcQ,e,mBAbN,eAYW,2BAZc,EAAAG,QAAQE,KAAG,SAAnBC,G,wBACf,eAUG,M,IAXuCA,EAAKC,S,CAE/C,eAQK,KARL,EAQK,CAPH,eAA0D,KAA1D,EAA0D,eAA9BD,EAAKE,YAAYC,OAAK,GAClD,eAA8B,SAA3B,QAAK,eAAGH,EAAKI,SAAO,I,mBACvB,eAIW,2BAJc,EAAAP,QAAQQ,QAAM,SAAtBL,G,wBACf,eAEQ,S,IAHqCA,EAAKM,U,eAE7CN,EAAKO,SAAU,KACpB,M,yBAYC,OACbC,MAAO,CACLX,QAAS,CAEPY,KAAMC,OACNC,QAHO,WAIL,MAAO,O,qBCzBf,MAAMC,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS,KAErD,QFsEA,GACbC,WAAY,CACVC,OAAA,GAEFC,KAJa,WAKX,MAAO,CACLC,YAAa,CACXC,SAAU,UACVC,UAAW,YAEbpB,MAAO,CACLC,IAAK,GACLM,OAAQ,IAEVc,aAAc,IACdvB,aAAa,IAGjBwB,QAAS,CAEPC,OAFO,WAEG,WACJC,UAAUC,YACZD,UAAUC,YAAYC,oBAAmB,SAAAC,GACvCC,QAAQC,IAAIF,EAASG,OAAOX,UAC5BS,QAAQC,IAAIF,EAASG,OAAOV,WAE5B,EAAKF,YAAYC,SAAWQ,EAASG,OAAOX,SAC5C,EAAKD,YAAYE,UAAYO,EAASG,OAAOV,UAE7C,EAAKW,YAEP,SAAAhD,GACE6C,QAAQC,IAAI9C,EAAMiD,YAGpBJ,QAAQC,IAAI,kDAGhBI,MApBO,WAsBL,IAAMC,EAAQ,mCACRC,EAAS,8BACTC,GAAY,IAAIC,MAAOC,cACvBC,EAAS,IAAI,OAAM,QAAS,QAClCA,EAAOC,WAAWL,EAAQ,QAC1BI,EAAOE,OAAO,WAAaL,GAC3B,IAAMM,EAAOH,EAAOI,QAAQ,OACtBC,EAAY,yBAAsBV,EAAtB,kEAAqFQ,EAArF,KAClB,MAAO,CAAEE,cAAeA,EAAe,SAAUR,IAGnDL,OAjCO,WAiCG,WACFc,EAAM,gGAA6FrD,KAAK0B,YAAYC,SAA9G,aAA2H3B,KAAK0B,YAAYE,UAA5I,aAA0J5B,KAAK6B,aAA/J,kBACZ7B,KAAKsD,MAAMC,IAAIF,EACb,CACEG,QAASxD,KAAKyC,UAEfgB,MAAK,SAACC,GACL,EAAKlD,MAAMC,IAAMiD,EAAIjC,KACrBW,QAAQC,IAAI,yBAA0B,EAAK5B,KAE3C,EAAKkD,YAENC,OAAM,SAAArE,GACL6C,QAAQC,IAAI,QAAS9C,EAAMsE,cAIjCF,OAlDO,WAkDG,WAER3D,KAAKQ,MAAMC,IAAItB,SAAQ,SAACuB,GACtB,IAAM2C,EAAM,2FAAwF3C,EAAKoD,UAA7F,yBACZ,EAAKR,MAAMC,IAAIF,EACb,CACEG,QAAS,EAAKf,UAEfgB,MAAK,SAACC,GACLtB,QAAQC,IAAI,UAAWqB,EAAIjC,MAC3B,EAAKjB,MAAMO,OAAS2C,EAAIjC,QAEzBmC,OAAM,SAAArE,GACL6C,QAAQC,IAAI,aAAc9C,EAAMsE,iBAKxCxD,OApEO,SAoEC0D,GACN/D,KAAK6B,aAAekC,EACpB/D,KAAKuC,SAEqB,MAAtBvC,KAAK6B,aACP7B,KAAKM,aAAc,EAEnBN,KAAKM,aAAc,IAIzB0D,QAjGa,WAkGXhE,KAAK+B,W,UGxKT,MAAM,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASkC,KAErD,gB,kCCRf,IAAIC,EAAQ,EAAQ,QAEpBrE,EAAOC,QAAU,SAAUqE,EAAaC,GACtC,IAAIC,EAAS,GAAGF,GAChB,QAASE,GAAUH,GAAM,WAEvBG,EAAOC,KAAK,KAAMF,GAAY,WAAc,MAAM,GAAM,Q,kCCP5D","file":"js/chunk-74acc47a.e9205bf7.js","sourcesContent":["var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar handlePrototype = function (CollectionPrototype) {\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  if (DOMIterables[COLLECTION_NAME]) {\n    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);\n  }\n}\n\nhandlePrototype(DOMTokenListPrototype);\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nmodule.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n// eslint-disable-next-line es/no-array-prototype-foreach -- safe\n} : [].forEach;\n","<template>\n<div class=\"container py-5\">\n  <div class=\"mb-4\">\n    <h3 class=\"text-primary\">Bus Stop | 附近站牌</h3>\n  </div>\n  <div class=\"bg-white p-5 rounded-1 shadow-sm\">\n    <h5>附近的站牌</h5>\n    <ul class=\"list-btn list-group flex-row\">\n      <li\n        @click=\"change(300)\"\n        :class=\"distanceBtn? 'active' : ''\"\n        class=\"list-group-item list-group-item-action border-0 text-center\">\n        <h5 class=\"m-0\">300 m</h5>\n      </li>\n      <li\n        @click=\"change(500)\"\n        :class=\"distanceBtn? '' : 'active'\"\n        class=\"list-group-item list-group-item-action border-0 text-center\">\n        <h5 class=\"m-0\">500 m</h5>\n      </li>\n    </ul>\n    <div class=\"distance\">\n      <NearBy\n        :getInfo=\"toApi\">\n      </NearBy>\n    </div>\n  </div>\n</div>\n</template>\n\n<style lang=\"scss\">\n  // search bar\n  body {\n    background-color: #F5F6FF;\n  }\n  .search-width {\n    width: 311px;\n  }\n  .form-control {\n    padding-right: 65px;\n  }\n  .search-btn {\n    position: absolute;\n    right: 0;\n    top: 0;\n    .search-icon {\n      filter: brightness(0.7);\n    }\n  }\n  // 分隔選單\n  .list-btn {\n    border-radius: 1rem 1rem 0 0;\n    overflow: hidden;\n  }\n  .distance {\n    background-color: #ECEEFF;\n    height: 60vh;\n    overflow: scroll;\n  }\n  .list-group-item {\n    border-radius: 1rem 1rem 0 0;\n    background-color: #BFCDFF;\n    color: white;\n    width: 50%;\n    &:first-child {\n      border-radius: 1rem 0 0 0;\n    }\n    &:last-child {\n      border-radius: 0 1rem 0 0;\n    }\n  }\n</style>\n\n<script>\nimport JsSHA from 'jssha'\nimport NearBy from '@/components/NearbyStop.vue'\n\nexport default {\n  components: {\n    NearBy\n  },\n  data () {\n    return {\n      nowLocation: {\n        latitude: 25.047675,\n        longitude: 121.517055\n      },\n      toApi: {\n        api: [],\n        busApi: []\n      },\n      distanceData: 300,\n      distanceBtn: true\n    }\n  },\n  methods: {\n    // 取得當下位置\n    getGeo () {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          console.log(position.coords.latitude)\n          console.log(position.coords.longitude)\n          // 重新定位\n          this.nowLocation.latitude = position.coords.latitude\n          this.nowLocation.longitude = position.coords.longitude\n          // 取得定位後，串接 api\n          this.getApi()\n        },\n        error => {\n          console.log(error.message)\n        })\n      } else {\n        console.log('Your browser does not support geolocation API')\n      }\n    },\n    apiID () {\n      // API 驗證\n      const AppID = process.env.VUE_APP_ID\n      const AppKey = process.env.VUE_APP_KEY\n      const GMTString = new Date().toGMTString()\n      const ShaObj = new JsSHA('SHA-1', 'TEXT')\n      ShaObj.setHMACKey(AppKey, 'TEXT')\n      ShaObj.update('x-date: ' + GMTString)\n      const HMAC = ShaObj.getHMAC('B64')\n      const Authorization = `hmac username=\"${AppID}\", algorithm=\"hmac-sha1\", headers=\"x-date\", signature=\"${HMAC}\"`\n      return { Authorization: Authorization, 'X-Date': GMTString }\n    },\n    // 取得指定[位置,範圍]的全臺公車站牌資料\n    getApi () {\n      const urlData = `https://ptx.transportdata.tw/MOTC/v2/Bus/Station/NearBy?$top=30&$spatialFilter=nearby(${this.nowLocation.latitude}, ${this.nowLocation.longitude}, ${this.distanceData})&$format=JSON`\n      this.$http.get(urlData,\n        {\n          headers: this.apiID()\n        })\n        .then((res) => {\n          this.toApi.api = res.data\n          console.log('ok取得指定[位置,範圍]的全臺公車站牌資料', this.api)\n          // bus api\n          this.getBus()\n        })\n        .catch(error => {\n          console.log('error', error.response)\n        })\n    },\n    // 取得指定站牌(item)公車路線資料\n    getBus () {\n      // 找到 getInfo 的 StationID\n      this.toApi.api.forEach((item) => {\n        const urlData = `https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Taichung/PassThrough/Station/${item.StationID}?$top=30&$format=JSON`\n        this.$http.get(urlData,\n          {\n            headers: this.apiID()\n          })\n          .then((res) => {\n            console.log('ok 公車路線', res.data)\n            this.toApi.busApi = res.data\n          })\n          .catch(error => {\n            console.log('error 公車路線', error.response)\n          })\n      })\n    },\n    // 更改距離\n    change (distance) {\n      this.distanceData = distance\n      this.getApi()\n      // 切換按鈕 style: active\n      if (this.distanceData === 300) {\n        this.distanceBtn = true\n      } else {\n        this.distanceBtn = false\n      }\n    }\n  },\n  created () {\n    this.getGeo()\n  }\n}\n</script>\n","<template>\n  <div class=\"hello\">\n    <table class=\"table table-striped table-hover\">\n      <tbody>\n        <template v-for=\"item in getInfo.api\" :key=\"item.StopUID\">\n          <tr>\n          <td class=\"px-4 py-3\">\n            <h5 class=\"text-primary\">{{ item.StationName.Zh_tw }}</h5>\n            <p>方位角： {{ item.Bearing }}</p>\n            <template v-for=\"item in getInfo.busApi\" :key=\"item.RouteUID\">\n              <small>\n                {{ item.RouteID }}、\n              </small>\n            </template>\n          </td>\n        </tr>\n        </template>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\n\nexport default {\n  props: {\n    getInfo: {\n      // api\n      type: Object,\n      default () {\n        return {}\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n</style>\n","import { render } from \"./NearbyStop.vue?vue&type=template&id=0595cc34\"\nimport script from \"./NearbyStop.vue?vue&type=script&lang=js\"\nexport * from \"./NearbyStop.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/pine_yu/Documents/my project/bus/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./StopInfo.vue?vue&type=template&id=a3682724\"\nimport script from \"./StopInfo.vue?vue&type=script&lang=js\"\nexport * from \"./StopInfo.vue?vue&type=script&lang=js\"\n\nimport \"./StopInfo.vue?vue&type=style&index=0&id=a3682724&lang=scss\"\n\nimport exportComponent from \"/Users/pine_yu/Documents/my project/bus/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./StopInfo.vue?vue&type=style&index=0&id=a3682724&lang=scss\""],"sourceRoot":""}