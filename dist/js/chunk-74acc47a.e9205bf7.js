(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74acc47a"],{"159b":function(t,e,o){var n=o("da84"),c=o("fdbc"),a=o("785a"),i=o("17c2"),s=o("9112"),r=function(t){if(t&&t.forEach!==i)try{s(t,"forEach",i)}catch(e){t.forEach=i}};for(var u in c)c[u]&&r(n[u]&&n[u].prototype);r(a)},"17c2":function(t,e,o){"use strict";var n=o("b727").forEach,c=o("a640"),a=c("forEach");t.exports=a?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},"427a":function(t,e,o){},"4c95":function(t,e,o){"use strict";o.r(e);var n=o("7a23"),c={class:"container py-5"},a=Object(n["f"])("div",{class:"mb-4"},[Object(n["f"])("h3",{class:"text-primary"},"Bus Stop | 附近站牌")],-1),i={class:"bg-white p-5 rounded-1 shadow-sm"},s=Object(n["f"])("h5",null,"附近的站牌",-1),r={class:"list-btn list-group flex-row"},u=Object(n["f"])("h5",{class:"m-0"},"300 m",-1),l=[u],f=Object(n["f"])("h5",{class:"m-0"},"500 m",-1),d=[f],b={class:"distance"};function p(t,e,o,u,f,p){var h=Object(n["x"])("NearBy");return Object(n["s"])(),Object(n["e"])("div",c,[a,Object(n["f"])("div",i,[s,Object(n["f"])("ul",r,[Object(n["f"])("li",{onClick:e[0]||(e[0]=function(t){return p.change(300)}),class:Object(n["n"])([f.distanceBtn?"active":"","list-group-item list-group-item-action border-0 text-center"])},l,2),Object(n["f"])("li",{onClick:e[1]||(e[1]=function(t){return p.change(500)}),class:Object(n["n"])([f.distanceBtn?"":"active","list-group-item list-group-item-action border-0 text-center"])},d,2)]),Object(n["f"])("div",b,[Object(n["h"])(h,{getInfo:f.toApi},null,8,["getInfo"])])])])}o("99af"),o("d3b7"),o("159b");var h=o("6c2d"),g={class:"hello"},O={class:"table table-striped table-hover"},j={class:"px-4 py-3"},v={class:"text-primary"};function w(t,e,o,c,a,i){return Object(n["s"])(),Object(n["e"])("div",g,[Object(n["f"])("table",O,[Object(n["f"])("tbody",null,[(Object(n["s"])(!0),Object(n["e"])(n["a"],null,Object(n["w"])(o.getInfo.api,(function(t){return Object(n["s"])(),Object(n["e"])("tr",{key:t.StopUID},[Object(n["f"])("td",j,[Object(n["f"])("h5",v,Object(n["z"])(t.StationName.Zh_tw),1),Object(n["f"])("p",null,"方位角： "+Object(n["z"])(t.Bearing),1),(Object(n["s"])(!0),Object(n["e"])(n["a"],null,Object(n["w"])(o.getInfo.busApi,(function(t){return Object(n["s"])(),Object(n["e"])("small",{key:t.RouteUID},Object(n["z"])(t.RouteID)+"、 ",1)})),128))])])})),128))])])])}var m={props:{getInfo:{type:Object,default:function(){return{}}}}},y=o("6b0d"),A=o.n(y);const B=A()(m,[["render",w]]);var D=B,x={components:{NearBy:D},data:function(){return{nowLocation:{latitude:25.047675,longitude:121.517055},toApi:{api:[],busApi:[]},distanceData:300,distanceBtn:!0}},methods:{getGeo:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){console.log(e.coords.latitude),console.log(e.coords.longitude),t.nowLocation.latitude=e.coords.latitude,t.nowLocation.longitude=e.coords.longitude,t.getApi()}),(function(t){console.log(t.message)})):console.log("Your browser does not support geolocation API")},apiID:function(){var t="d270b525f2114a95895b7670090cb92c",e="Pwts_rFo3XHtvuvjDziNlG6fqvM",o=(new Date).toGMTString(),n=new h["a"]("SHA-1","TEXT");n.setHMACKey(e,"TEXT"),n.update("x-date: "+o);var c=n.getHMAC("B64"),a='hmac username="'.concat(t,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(c,'"');return{Authorization:a,"X-Date":o}},getApi:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bus/Station/NearBy?$top=30&$spatialFilter=nearby(".concat(this.nowLocation.latitude,", ").concat(this.nowLocation.longitude,", ").concat(this.distanceData,")&$format=JSON");this.$http.get(e,{headers:this.apiID()}).then((function(e){t.toApi.api=e.data,console.log("ok取得指定[位置,範圍]的全臺公車站牌資料",t.api),t.getBus()})).catch((function(t){console.log("error",t.response)}))},getBus:function(){var t=this;this.toApi.api.forEach((function(e){var o="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Taichung/PassThrough/Station/".concat(e.StationID,"?$top=30&$format=JSON");t.$http.get(o,{headers:t.apiID()}).then((function(e){console.log("ok 公車路線",e.data),t.toApi.busApi=e.data})).catch((function(t){console.log("error 公車路線",t.response)}))}))},change:function(t){this.distanceData=t,this.getApi(),300===this.distanceData?this.distanceBtn=!0:this.distanceBtn=!1}},created:function(){this.getGeo()}};o("cc3f");const I=A()(x,[["render",p]]);e["default"]=I},a640:function(t,e,o){"use strict";var n=o("d039");t.exports=function(t,e){var o=[][t];return!!o&&n((function(){o.call(null,e||function(){throw 1},1)}))}},cc3f:function(t,e,o){"use strict";o("427a")}}]);
//# sourceMappingURL=chunk-74acc47a.e9205bf7.js.map